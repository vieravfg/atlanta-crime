<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Prophet</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="../static/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="../static/vendor/aos/aos.css" rel="stylesheet">
  <link href="../static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../static/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="../static/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="../static/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="../static/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="../static/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="../static/css/style.css" rel="stylesheet">

  <!-- =======================================================
  
  ======================================================== -->
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top d-flex align-items-center header-scrolled">
    <div class="container">
      <div class="header-container d-flex align-items-center justify-content-between">
        <div class="logo">
          <h1 class="text-light"><a href="/"><span>Crime Analysis Project</span></a></h1>
          <!-- Uncomment below if you prefer to use an image logo -->
        </div>

        <nav id="navbar" class="navbar">
          <ul>
            <li><a class="nav-link scrollto active" href="/#hero">Home</a></li>
            <li><a class="nav-link scrollto" href="/#about">About</a></li>
            <li><a class="nav-link scrollto" href="/#services">Machine Learning</a></li>
            <li><a class="nav-link scrollto " href="/#portfolio">Visualizations</a></li>
            <li><a class="nav-link scrollto" href="/#team">Team</a></li>
            <li class="dropdown"><a href="#"><span> Graphs</span> <i class="bi bi-chevron-down"></i></a>
              <ul>
                <li><a href="/page1">Crime and Demographics</a></li>
                <li><a href="/page5">Crime Time and Type</a></li>
                <li class="dropdown"><a href="#"><span>Machine Learning</span> <i class="bi bi-chevron-right"></i></a>
                  <ul>
                    <li><a href="/arima.html">ARIMA</a></li>
                    <li><a href="/prophet.html">Prophet</a></li>
                    <li><a href="/ml.html">Our Model</a></li>
                  </ul>
                </li>
                <li><a href="/page2">Crime Types &amp; Total Count</a></li>
                <li><a href="/page3">Crime Count by Year </a></li>
                <li><a href="/page4">Crime Type by Zipcode</a></li>
              </ul>
            </li>
            <li><a class="nav-link scrollto" href="/#contact">Contact</a></li>
            <li><a class="getstarted scrollto" href="/#about">Get Started</a></li>
          </ul>
          <i class="bi bi-list mobile-nav-toggle"></i>
        </nav><!-- .navbar -->

      </div><!-- End Header Container -->
    </div>
  </header><!-- End Header -->

  <main id="main">

    <!-- ======= Breadcrumbs ======= -->
    <section class="breadcrumbs">
      <div class="container">

        <div class="d-flex justify-content-between align-items-center">
          <h2 style="color: #862727">Time Series Forecasting - Prophet - Summary</h2>
          <ol>
            <li><a href="/">Home</a></li>
            <li> Prophet </li>
          </ol>
        </div>

        <!-- ======== Step 1 ======== -->
        <p><b>Step 1 - Data Preparation</b></p>
        <p>We aggregated the Atlanta crimes by date and 
          sorted by date ascending. </p>
          <pre>                    
            ds                   y                 
            2009-01-01           116
            2009-01-02           136
            2009-01-03           113
            2009-01-04           97
            2009-01-05           129
          </pre>

          <!-- ======== Step 2 ======== -->
          <p><b>Step 2 - Review Data</b></p>

          <p>
            To get a general understanding and overview of our data
            we created a plot of crimes per date over our 10 year
            period to see if there were any
            noticable trends. There appeared to be a 
            consistent trend with the crime rate gradually 
            falling each year.
          </p>
          <img src="../static/img/data_overview.png" width="650px" height="200px">

          <br>
          <br>

          <!-- ======== Step 3 ======== -->
          <p><b>Step 3 - Model, Fit, Predict</b></p>
          
          <p>We first split our data into a training set and a 
            testing set. We used 80% of our data for training and 
            the remaining 20% for testing.
          </p>
          
          <p>
            Next we used cross validation to tune the hyperparameters.
            Using code from the 
            <a href="https://facebook.github.io/prophet/docs/diagnostics.html" target="_blank">Prophet diagnostics page
            </a>
            we found these to be the best hyperparameters for our model: 
          </p>
          <ul>
            <li>Changepoint Prior Scale: 0.01</li>
            <li>Seasonality Prior Scale: 0.01</li>
          </ul>
          
          <p><u>Training Data</u></p>
          <p>
            We then created and fit our model using our training
            data and the proper hyperparameters. 
          </p>
          <br>

          <div class="row">

            <div class="col-lg-6 col-md-12 col-sm-12">
              <img height="350px" width="650px" src="../static/img/first_forecast.png">


</div>
<div class="col-lg-6 col-md-12 col-sm-12">

                              <img src="../static/img/weekly.png" width="400px" height="116px" style="padding-bottom: 10px;">
              <!--<img src="/Project_Screenshots/weekly.png" width = "400px" height = "100px" style="margin-left:25px">-->


            <br>

                              <img src="../static/img/yearly.png" width="400px" height="116px" style="padding-bottom: 10px;">


            <br>

                              <img src="../static/img/monthly.png" width="400px" height="116px">


            </div>

            

          </div> <!--end of row-->
          
          <br>
          <br>
          

        

          <p>Scores for our training data:
            </p><ul>
              <li>R2: .55</li>
              <li>MSE: 136.6</li>
            </ul> 
          <p></p>

          <p><u>Testing Data</u></p>
          <p>
            We then used our model to predict values on our testing set. Our R2 value for our testing set decreased to .148.  
          </p>
          <p>
          The chart below shows the actual number of crimes 
            each day (blue) compared to the predicted number of crimes (red).
          </p>
          <img src="../static/img/testing_data.png" width="900px" height="250px">

      
<br>
<br>
          <p>This model seems to 
            be more sensitive to outliers. You can see around December and January 
            of both years there are a few outliers which drag the predicted values in 
            February down. 
            However, in both years crime actually 
            increased in February. Prophet appears to be more driven by outliers than ARIMA.
          </p>
          <!-- ======== Step 4 ======== -->
          <p><b>Step 4 - Forecasting</b></p>
          
          <p>Finally, we created and fit a model using our entire dataset and predicted the number of crimes for the following two years (2020-2021).
          </p>
          <br>
         

          <div class="row">
            
            
            <div class="col-md-6 col-lg-3 col-sm-6">
              <pre>                prediction
   2020-01-01   56.456298
   2020-01-02   55.294014
   2020-01-03   56.452136
   2020-01-04   57.189774
   2020-01-05   51.312000
   ...                ...
   2021-12-27   57.271766
   2021-12-28   53.167488
   2021-12-29   50.616308
   2021-12-30   49.285891
   2021-12-31   50.275311      
</pre>
            </div>
            <div class="col-md-6 col-sm-6">
              <img src="../static/img/final_forecast.png" width="615px" height="275px">
            </div>
        </div>
        
          <br>
          
            
          
            <p>
              R2 value of .558. 

            </p>


          <!-- ======== Step 5 ======== -->
        
          <p><b>Step 5 - Analysis and What We Learned</b></p>


          <p><u>Analysis</u></p>
          <p>
            Compared to ARIMA, Prophet had better accuracy in predicting 
            the correct number of crimes that occurred each day. When comparing ARIMA's predictions 
            on the testing set to Prophet's predictions on the testing set, you can see 
            that the predictions the ARIMA model made are more conservative than Prophet's predictions; 
            it was less driven by the outliers. 
            You also see this in the interactive graph, on the "Our Model" page, which shows the two predictions together. The models predict 
            very similar shapes and patterns, but the ARIMA model has a more stable mean whereas 
            the Prophet model is much more varied in its predictions. However, they both show a general 
            downward trend.
          </p>

          <p><u>What We Learned and How to Improve</u></p>

          <p>
            While Prophet made more accurate predictions, the r2 score was still only a little over .50. What we learned from 
            this is that it takes a lot of time and trial-and-error to find the best method for your data and then to find the best ways 
            to tune and improve your model.
          </p>

          <p>
            Going forward, if we had more time to improve our models and predictions, we would 
            either try a new, non-time series forecasting model or, for the Prophet model, we would look into the outliers. We would be interested to learn more about seasonality and holidays in Prophet and how to potentially 
            incorporate more hyperparameters based on our outliers and/or seasonal trends. Overall we learned a lot about the 
            machine learning process and are
            excited to learn more moving forward.
          </p>
          
            

      </div>
    </section><!-- End Breadcrumbs -->

    <section class="inner-page">
      <div class="container">
      
      </div>
    </section>

  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer">

    <div class="footer-top">
      <div class="container">
        <div class="row">

          <div class="col-lg-3 col-md-6 footer-contact">
            <h3>Georgia Tech Bootcamp Project</h3>
          
          </div>

          <div class="col-lg-2 col-md-6 footer-links">
            <h4>Useful Links</h4>
            <ul>
              <li><i class="bx bx-chevron-right"></i> <a nav-link="" scrollto="" href="/#hero">Home</a></li>
              <li><i class="bx bx-chevron-right"></i> <a nav-link="" scrollto="" href="/#team">About us</a></li>
            </ul>
          </div>

          <div class="col-lg-3 col-md-6 footer-links">
            <h4>Our Data Sources</h4>
            <ul>
              <li><i class="bx bx-chevron-right"></i> <a href="https://www.atlantapd.org/i-want-to/crime-data-downloads
                " target="_blank">Atlanta's Crime Data </a></li>
              
            </ul>
          </div>

        </div>
      </div>
    </div>

    <div class="container d-md-flex py-4">

      <div class="me-md-auto text-center text-md-start">
        <div class="copyright">
          © Copyright <strong><span>Bethany</span></strong>. All Rights Reserved
        </div>
        <div class="credits">
          <!-- All the links in the footer should remain intact. -->
          <!-- You can delete the links only if you purchased the pro version. -->
          <!-- Licensing information: https://bootstrapmade.com/license/ -->
          <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/bethany-free-onepage-bootstrap-theme/ -->
          Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
        </div>
      </div>
    </div>
  </footer>
  <!-- End Footer -->
  <a href="#" class="back-to-top d-flex align-items-center justify-content-center active"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor CSS Files -->
  <link href="../static/vendor/aos/aos.css" rel="stylesheet">
  <link href="../static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../static/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="../static/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="../static/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="../static/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="../static/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main JS File -->
  <script src="../static/js/betmain.js"></script>



</body></html>